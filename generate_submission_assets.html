<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ManuScript.ai - Submission Asset Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <script type="importmap">
      {
        "imports": {
          "@google/genai": "https://esm.sh/@google/genai@^1.32.0"
        }
      }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #020617; color: #e2e8f0; }
        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(99, 102, 241, 0.2); }
        .loader {
            border: 3px solid rgba(255,255,255,0.1);
            border-left-color: #6366f1;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-6 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-indigo-950 via-slate-950 to-black">

    <div class="glass w-full max-w-2xl rounded-2xl shadow-2xl overflow-hidden">
        <!-- Header -->
        <div class="bg-indigo-600/10 border-b border-indigo-500/20 p-6 flex items-center gap-4">
            <div class="p-3 bg-indigo-600 rounded-lg shadow-lg shadow-indigo-500/30">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7-5-7 5V20z"/><path d="M12 12v8"/><path d="M12 12l4-2.5"/><path d="M12 12L8 9.5"/></svg>
            </div>
            <div>
                <h1 class="text-2xl font-bold text-white tracking-tight">ManuScript.ai</h1>
                <p class="text-indigo-300 text-xs font-medium uppercase tracking-wider">Submission Asset Generator</p>
            </div>
        </div>

        <!-- Controls -->
        <div class="p-8 space-y-6">
            
            <div>
                <label class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">Gemini API Key</label>
                <input type="password" id="apiKey" placeholder="Enter your key here..." class="w-full bg-slate-950 border border-slate-700 rounded-lg p-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none transition-all" />
                <p class="text-[10px] text-slate-500 mt-1">Required to access gemini-2.5-flash-image model.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="p-4 bg-slate-900/50 rounded-xl border border-slate-800">
                    <h3 class="font-bold text-white mb-2">Submission Card</h3>
                    <p class="text-xs text-slate-400 mb-4">560x280 px • PNG Format</p>
                    <label class="flex items-center gap-2 text-sm text-slate-300 mb-4 cursor-pointer">
                        <input type="checkbox" id="addText" checked class="accent-indigo-500">
                        Overlay App Name
                    </label>
                    <button onclick="generateAsset('card')" id="btn-card" class="w-full py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg font-medium transition-all shadow-lg shadow-indigo-500/20 flex justify-center items-center gap-2">
                        <span>Generate Card</span>
                    </button>
                </div>

                <div class="p-4 bg-slate-900/50 rounded-xl border border-slate-800">
                    <h3 class="font-bold text-white mb-2">App Icon</h3>
                    <p class="text-xs text-slate-400 mb-4">512x512 px • PNG Format</p>
                    <div class="h-[21px] mb-4"></div> <!-- Spacer -->
                    <button onclick="generateAsset('icon')" id="btn-icon" class="w-full py-2 bg-slate-800 hover:bg-slate-700 text-slate-200 border border-slate-700 rounded-lg font-medium transition-all flex justify-center items-center gap-2">
                        <span>Generate Icon</span>
                    </button>
                </div>
            </div>

            <!-- Preview Area -->
            <div id="previewContainer" class="hidden animate-in fade-in slide-in-from-bottom-4">
                <div class="flex items-center justify-between mb-2">
                    <h3 class="text-sm font-bold text-white">Preview</h3>
                    <span class="text-xs text-indigo-400" id="previewDims"></span>
                </div>
                <div class="relative bg-black rounded-lg overflow-hidden border border-slate-700 shadow-2xl flex items-center justify-center bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]">
                    <canvas id="outputCanvas" class="max-w-full h-auto"></canvas>
                </div>
                <p class="text-center text-xs text-slate-500 mt-3">Right-click the image above to "Save Image As..."</p>
            </div>
            
            <div id="errorMsg" class="hidden p-3 bg-rose-950/30 border border-rose-500/30 rounded-lg text-rose-300 text-sm text-center"></div>

        </div>
    </div>

    <script type="module">
        import { GoogleGenAI } from "@google/genai";

        window.generateAsset = async (type) => {
            const key = document.getElementById('apiKey').value;
            const errorEl = document.getElementById('errorMsg');
            const previewEl = document.getElementById('previewContainer');
            
            if (!key) {
                errorEl.textContent = "Please enter your Gemini API Key.";
                errorEl.classList.remove('hidden');
                return;
            }
            errorEl.classList.add('hidden');

            const btnId = type === 'card' ? 'btn-card' : 'btn-icon';
            const btn = document.getElementById(btnId);
            const originalText = btn.innerHTML;
            btn.innerHTML = `<div class="loader"></div> Processing...`;
            btn.disabled = true;

            try {
                const ai = new GoogleGenAI({ apiKey: key });
                
                // Prompts tuned for "Industrial IoT" aesthetic
                const cardPrompt = `
                    A cinematic, high-tech abstract background for an Industrial IoT dashboard. 
                    Dark slate and deep blue color palette. 
                    Glowing cyan and purple data streams, wireframe geometry of factory machines, circuit board patterns.
                    Futuristic, clean, professional, 8k resolution, highly detailed. 
                    No text.
                `;

                const iconPrompt = `
                    A minimalist, modern app logo icon for an Industrial AI app.
                    A stylized letter 'M' interwoven with a digital circuit node and a factory gear.
                    Gradient indigo to cyan on a dark slate background.
                    Vector art style, flat design, high contrast, clean lines.
                `;

                const aspectRatio = type === 'card' ? '16:9' : '1:1';
                
                const response = await ai.models.generateContent({
                    model: 'gemini-2.5-flash-image',
                    contents: { parts: [{ text: type === 'card' ? cardPrompt : iconPrompt }] },
                    config: {
                        imageConfig: { aspectRatio: aspectRatio, numberOfImages: 1 }
                    }
                });

                const base64 = response.candidates?.[0]?.content?.parts?.[0]?.inlineData?.data;
                
                if (!base64) throw new Error("No image generated.");

                // Process Image on Canvas
                const img = new Image();
                img.onload = () => {
                    const canvas = document.getElementById('outputCanvas');
                    const ctx = canvas.getContext('2d');
                    
                    // Set Target Dimensions
                    const targetWidth = type === 'card' ? 560 : 512;
                    const targetHeight = type === 'card' ? 280 : 512;
                    
                    canvas.width = targetWidth;
                    canvas.height = targetHeight;
                    
                    // Draw Image (Cover Fit)
                    const scale = Math.max(targetWidth / img.width, targetHeight / img.height);
                    const x = (targetWidth / 2) - (img.width / 2) * scale;
                    const y = (targetHeight / 2) - (img.height / 2) * scale;
                    ctx.drawImage(img, x, y, img.width * scale, img.height * scale);

                    // Optional Text Overlay for Card
                    if (type === 'card' && document.getElementById('addText').checked) {
                        // Shadow
                        ctx.shadowColor = "rgba(0,0,0,0.8)";
                        ctx.shadowBlur = 15;
                        
                        // Text
                        ctx.font = "bold 48px Inter, sans-serif";
                        ctx.fillStyle = "white";
                        ctx.textAlign = "center";
                        ctx.textBaseline = "middle";
                        ctx.fillText("ManuScript.ai", targetWidth / 2, targetHeight / 2);
                        
                        // Subtitle
                        ctx.font = "500 14px Inter, sans-serif";
                        ctx.fillStyle = "#a5b4fc";
                        ctx.shadowBlur = 5;
                        ctx.fillText("PREDICTIVE MAINTENANCE SUITE", targetWidth / 2, (targetHeight / 2) + 35);
                    }

                    // Show Result
                    document.getElementById('previewDims').textContent = `${targetWidth} x ${targetHeight} px`;
                    previewEl.classList.remove('hidden');
                    
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                };
                img.src = `data:image/png;base64,${base64}`;

            } catch (e) {
                console.error(e);
                errorEl.textContent = "Generation failed. Please check your API key and try again.";
                errorEl.classList.remove('hidden');
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        };
    </script>
</body>
</html>